import numpy as np
import math
import random
import os, fnmatch
import cv2

def navie_bayes(X_train, y_train, X_test):
    # Calculate p(y)
    classes, classes_count = np.unique(y_train, return_counts = True)
    classes_prob = classes_count / len(y_train)

    # Calculate p(X|y)
    classes_mean = []
    classes_std = []
    for i in range(len(classes)):
        class_X = np.array(X_train[np.where(y_train == classes[i])])
        classes_mean.append(np.mean(class_X, axis=0))   # TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'
        classes_std.append(np.std(class_X, axis=0))	  # TypeError: unsupported operand type(s) for +: 'NoneType' and 'NoneType'

    # Suppose X has Gaussian distribution
    y_pred = []
    for x in X_test:
        probs = []
        for i in range(len(classes)):
            prob = 1
            for j in range(len(x)):
                prob *= (1 / (np.sqrt(2 * np.pi * classes_std[i][j] ** 2))) * np.exp(-(x[j] - classes_mean[i][j]) ** 2 / (2 * classes_std[i][j] ** 2))
            probabilities.append(probability)
        # Choose the max prob
        y_pred.append(classes[np.argmax(probs)])

    return y_pred